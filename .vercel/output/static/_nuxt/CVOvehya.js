import{_ as i}from"./DRujum_f.js";import{u as C,c as E,e as j,n as w}from"./CQA7Wwdt.js";import{E as _,$ as a,a3 as o,z as p,X as l,W as d,a4 as L,b as c,U as n,a5 as u}from"./BD3EHYnG.js";const T={class:"min-h-screen bg-gradient-to-br from-primary-50 via-white to-secondary-50 flex items-center justify-center py-12 px-4"},z={class:"relative z-10 w-full max-w-md"},M={class:"bg-white rounded-2xl shadow-strong p-8 border border-neutral-100"},P={key:0,class:"text-center"},N={key:1,class:"text-center"},B={key:2,class:"text-center"},S={class:"text-danger-600 mb-4"},A={class:"space-y-3"},V={key:3,class:"text-center"},R={__name:"confirm",setup(I){C({title:"Confirma√ß√£o de Email - Sistema de Portaria",meta:[{name:"description",content:"Confirme seu email para ativar sua conta"}]});const x=E(),g=j(),r=c(!0),m=c(!1),f=c(!1),y=c(""),h=async()=>{r.value=!0,f.value=!1;try{console.log("üìç P√°gina /confirm carregada"),console.log("üîç URL completa:",window.location.href),console.log("üîç Hash:",window.location.hash);const t=window.location.hash.match(/type=([^&]+)/)?.[1];if(console.log("üìã Tipo detectado:",t),t==="recovery"){console.log("üîê Recovery detectado - redirecionando IMEDIATAMENTE");const s="/redefinir-senha"+window.location.hash;console.log("üìç Destino:",s),window.location.replace(s);return}console.log("üìß Processando confirma√ß√£o de email normal");const e=g.query.token||g.hash.match(/access_token=([^&]+)/)?.[1];if(console.log("üîë Token extra√≠do:",e?"Presente":"Ausente"),!e){console.log("‚ö†Ô∏è Nenhum token encontrado - saindo..."),r.value=!1;return}const{data:{user:k}}=await x.auth.getUser();if(k)m.value=!0,setTimeout(()=>{w("/")},2e3);else{const{error:s}=await x.auth.verifyOtp({token_hash:e,type:t||"email"});if(s)throw s;m.value=!0}}catch(t){console.error("Erro na confirma√ß√£o:",t),f.value=!0,y.value=t.message||"Erro ao confirmar email. Tente novamente."}finally{r.value=!1}},b=()=>{h()},v=()=>{w("/login")};return _(()=>{h()}),(t,e)=>(n(),a("div",T,[e[11]||(e[11]=o("div",{class:"absolute inset-0 overflow-hidden pointer-events-none"},[o("div",{class:"absolute -top-40 -right-40 w-80 h-80 bg-primary-100 rounded-full opacity-20 blur-3xl"}),o("div",{class:"absolute -bottom-40 -left-40 w-96 h-96 bg-secondary-100 rounded-full opacity-20 blur-3xl"})],-1)),o("div",z,[o("div",M,[r.value?(n(),a("div",P,[...e[0]||(e[0]=[o("div",{class:"flex justify-center mb-4"},[o("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})],-1),o("h2",{class:"text-xl font-semibold text-secondary-800 mb-2"}," Confirmando seu email... ",-1),o("p",{class:"text-secondary-600"},"Aguarde um momento",-1)])])):m.value?(n(),a("div",N,[e[2]||(e[2]=p('<div class="flex justify-center mb-4"><div class="w-16 h-16 bg-success-100 rounded-full flex items-center justify-center"><svg class="w-8 h-8 text-success-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div></div><h2 class="text-2xl font-bold text-secondary-800 mb-2"> Email Confirmado! </h2><p class="text-secondary-600 mb-6"> Sua conta foi ativada com sucesso. Agora voc√™ j√° pode fazer login no sistema. </p>',3)),l(i,{onClick:v,variant:"primary",size:"lg","full-width":""},{default:d(()=>[...e[1]||(e[1]=[u(" Ir para Login ",-1)])]),_:1})])):f.value?(n(),a("div",B,[e[5]||(e[5]=p('<div class="flex justify-center mb-4"><div class="w-16 h-16 bg-danger-100 rounded-full flex items-center justify-center"><svg class="w-8 h-8 text-danger-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></div></div><h2 class="text-2xl font-bold text-secondary-800 mb-2"> Erro na Confirma√ß√£o </h2>',2)),o("p",S,L(y.value),1),e[6]||(e[6]=o("p",{class:"text-sm text-secondary-600 mb-6"}," Poss√≠veis causas: ",-1)),e[7]||(e[7]=o("ul",{class:"text-sm text-secondary-600 text-left space-y-2 mb-6"},[o("li",null,"‚Ä¢ Link expirado ou inv√°lido"),o("li",null,"‚Ä¢ Email j√° confirmado anteriormente"),o("li",null,"‚Ä¢ Problemas de conex√£o")],-1)),o("div",A,[l(i,{onClick:b,variant:"primary",size:"md","full-width":""},{default:d(()=>[...e[3]||(e[3]=[u(" Tentar Novamente ",-1)])]),_:1}),l(i,{onClick:v,variant:"outline",size:"md","full-width":""},{default:d(()=>[...e[4]||(e[4]=[u(" Voltar para Login ",-1)])]),_:1})])])):(n(),a("div",V,[e[9]||(e[9]=p('<div class="flex justify-center mb-4"><div class="w-16 h-16 bg-warning-100 rounded-full flex items-center justify-center"><svg class="w-8 h-8 text-warning-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg></div></div><h2 class="text-2xl font-bold text-secondary-800 mb-2"> Confirma√ß√£o de Email </h2><p class="text-secondary-600 mb-6"> Para confirmar seu email, clique no link que enviamos para sua caixa de entrada. </p>',3)),l(i,{onClick:v,variant:"primary",size:"lg","full-width":""},{default:d(()=>[...e[8]||(e[8]=[u(" Ir para Login ",-1)])]),_:1})]))]),e[10]||(e[10]=o("div",{class:"mt-6 text-center"},[o("p",{class:"text-sm text-secondary-500"}," Sistema de Portaria - Confirma√ß√£o de Cadastro ")],-1))])]))}};export{R as default};
